<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
  <title>Happy Birthday Prasansha!</title>
  <link href="https://fonts.cdnfonts.com/css/winky-rough" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    * { box-sizing: border-box; }
    @import url('https://fonts.googleapis.com/css2?family=Zilla+Slab:ital,wght@0,700;1,700&display=swap');

    /* Add these new styles for beautiful final messages */
    .final-message-container {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(18, 18, 18, 0.95), rgba(30, 30, 40, 0.98));
      z-index: 2000;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      padding: 20px;
      backdrop-filter: blur(10px);
    }

    .message-box {
      background: linear-gradient(145deg, rgba(40, 40, 50, 0.9), rgba(30, 30, 40, 0.95));
      border-radius: 20px;
      padding: 30px;
      max-width: 90%;
      width: 600px;
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.5),
        0 0 0 1px rgba(232, 67, 147, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(232, 67, 147, 0.3);
      position: relative;
      overflow: hidden;
      transform: translateY(30px);
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .message-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #ff6b6b, #e84393, #a29bfe);
      border-radius: 20px 20px 0 0;
    }

    .message-box.show {
      transform: translateY(0);
      opacity: 1;
    }

    .message-content {
      color: #e0e0e0;
      font-family: 'Montserrat', sans-serif;
      line-height: 1.7;
      text-align: center;
    }

    .message-title {
      font-size: 1.8em;
      color: #ff6b6b;
      margin-bottom: 25px;
      font-weight: 600;
      text-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);
      letter-spacing: 0.5px;
    }

    .message-body {
      font-size: 1.1em;
      margin-bottom: 20px;
      font-weight: 400;
    }

    .message-highlight {
      font-size: 1.3em;
      color: #e84393;
      font-weight: 500;
      margin: 25px 0;
      text-shadow: 0 2px 8px rgba(232, 67, 147, 0.3);
      line-height: 1.6;
    }

    .message-footer {
      font-size: 0.9em;
      opacity: 0.7;
      margin-top: 30px;
      font-style: italic;
    }

    .blurred-text {
      filter: blur(8px);
      transition: all 0.6s ease;
      cursor: pointer;
      position: relative;
    }

    .blurred-text:hover {
      filter: blur(0);
    }

    .blurred-text::after {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(232, 67, 147, 0.9);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.8em;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      white-space: nowrap;
    }

    .blurred-text:hover::after {
      opacity: 1;
    }

    .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(232, 67, 147, 0.2);
      border: 1px solid rgba(232, 67, 147, 0.4);
      color: #ff6b6b;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      font-size: 1.3em;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      z-index: 2001;
    }

    .close-btn:hover {
      background: rgba(232, 67, 147, 0.3);
      transform: scale(1.1);
    }

    .floating-hearts {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .floating-heart {
      position: absolute;
      font-size: 20px;
      opacity: 0;
      animation: float-heart 6s ease-in-out infinite;
    }

    @keyframes float-heart {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) rotate(360deg);
        opacity: 0;
      }
    }

    /* Mobile responsiveness for final messages */
    @media (max-width: 768px) {
      .message-box {
        padding: 25px 20px;
        max-width: 95%;
        margin: 10px;
      }

      .message-title {
        font-size: 1.5em;
        margin-bottom: 20px;
      }

      .message-body {
        font-size: 1em;
      }

      .message-highlight {
        font-size: 1.1em;
      }

      .close-btn {
        width: 40px;
        height: 40px;
        font-size: 1.1em;
        top: 15px;
        right: 15px;
      }

      .blurred-text::after {
        font-size: 0.7em;
        padding: 6px 12px;
      }
    }

    @media (max-width: 480px) {
      .message-box {
        padding: 20px 15px;
        border-radius: 15px;
      }

      .message-title {
        font-size: 1.3em;
      }

      .message-body {
        font-size: 0.95em;
        line-height: 1.6;
      }

      .message-highlight {
        font-size: 1em;
        margin: 20px 0;
      }

      .blurred-text {
        filter: blur(6px);
      }
    }

    /* Rest of your existing CSS remains the same */
    .welcome-message {
      position:fixed;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      font-family: 'Zilla Slab', serif;
      font-weight: 700;
      font-size:2.5em;
      color:#e84393;
      text-shadow:2px 2px 4px rgba(0,0,0,0.3);
      opacity:0;
      z-index:100;
      pointer-events:none;
    }

    @media (max-width: 768px) {
      body {
        justify-content: flex-start;
        padding: 10px 0;
        overflow-y: auto;
      }
      #wish-text:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      
      .container {
        padding: 15px;
        margin-top: 20px;
      }
      
      .memory-gallery {
        gap: 10px;
        margin-bottom: 20px;
      }
      
      .memory-item {
        width: 45%;
        height: 120px;
      }
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, rgba(232, 67, 147, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(157, 78, 221, 0.1) 0%, transparent 50%);
      animation: gentlePulse 8s ease-in-out infinite;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes gentlePulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 0.8; }
    }

    .shooting-star {
      position: fixed;
      width: 4px;
      height: 4px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 10px 2px white;
      opacity: 0;
      z-index: 1;
      animation: shootStar 3s ease-out forwards;
    }

    @keyframes shootStar {
      0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translate(100vw, 100vh) rotate(360deg);
        opacity: 0;
      }
    }

    h1 {
      margin-bottom: 20px !important;
    }

    body {
      margin:0; padding:0;
      font-family:'Montserrat',sans-serif;
      text-align:center;
      transition:background-color 0.5s;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      align-items:center;
      background:#121212;
      color: #e0e0e0;
      overflow-x:hidden;
      position: relative;
      padding: 20px 0;
    }

    .container { 
      max-width:800px; 
      width:95%; 
      padding:20px; 
      position:relative; 
      z-index:10;
      margin: auto;
    }

    #gift-button {
      display: none;
      opacity: 0;
      transition: opacity 1s ease;
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      background: linear-gradient(45deg, #ff6b6b, #e84393);
      color: white;
      font-weight: bold;
      font-size: 1.1em;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(255,107,107,0.3);
      user-select:none;
      margin: 10px auto;
    }

    #gift-button:hover {
      background: linear-gradient(45deg, #e84393, #ff6b6b);
      box-shadow: 0 6px 20px rgba(0,0,0,0.4);
    }

    #memories-button, #show-memories-button {
      background: linear-gradient(45deg, #0984e3, #74b9ff);
      display: none;
      padding: 10px 22px;
      border: none;
      border-radius: 20px;
      color: white;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 3px 12px rgba(9,132,227,0.3);
      user-select:none;
      margin: 10px auto;
    }
    
    #lightbox-modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    #lightbox-content img, 
    #lightbox-content video {
      max-width: 90%;
      max-height: 80vh;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
    }

    #memories-button:hover, #show-memories-button:hover {
      background: linear-gradient(45deg, #74b9ff, #0984e3);
    }

    .cake-container {
      position: relative;
      display: none;
      margin: 20px 0 30px 0;
      z-index: 5;
      cursor: pointer;
    }

    .cake {
      width: 180px;
      height: 100px;
      background: linear-gradient(to bottom, #f9c5d1, #f8a5c2);
      border-radius: 10px 10px 0 0;
      position: relative;
      margin: 0 auto;
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    }

    .cake:before {
      position: absolute;
      content: '';
      top: -10px;
      left: -10px;
      width: 200px;
      height: 20px;
      background: linear-gradient(to right, #f999b7, #f67eaa);
      border-radius: 10px;
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    }

    .candle {
      width:8px;
      height:40px; 
      background:linear-gradient(to bottom,#fff,#f0f0f0);
      position:absolute; 
      top:-45px;
      left:50%; 
      transform:translateX(-50%);
      border-radius:5px; 
      cursor:pointer; 
      box-shadow:0 2px 5px rgba(0,0,0,0.2);
    }

    .flame {
      width:12px;
      height:25px; 
      background:radial-gradient(#ffef00,#ff9e00);
      position:absolute; 
      top:-25px;
      left:50%; 
      transform:translateX(-50%);
      opacity:0; 
      border-radius:50% 50% 20% 20%; 
      filter:blur(1px);
      box-shadow:0 0 20px #ff6600,0 0 40px #ff9900;
    }
    .flame.burning { 
      opacity:1; 
      animation:flicker 0.5s infinite alternate; 
    }
    @keyframes flicker {
      0% { opacity:1; transform:translateX(-50%) scale(1); }
      100% { opacity:0.8; transform:translateX(-50%) scale(1.1); }
    }
    .birthday-message {
      font-size:1.1em; 
      color:#e0e0e0; 
      background:rgba(30,30,30,0.8);
      padding:20px; 
      border-radius:15px; 
      margin:20px 0; 
      max-width:90%;
      box-shadow:0 5px 15px rgba(0,0,0,0.3); 
      display:none; 
      line-height:1.6;
      white-space: pre-wrap;
      border: 1px solid #444;
    }
    .memory-gallery {
      display:none; 
      margin-top:20px; 
      flex-wrap:wrap; 
      justify-content:center; 
      gap:15px;
    }
    .memory-item {
      width:150px;
      height:150px;
      background:#2a2a2a;
      border-radius:12px;
      overflow:hidden;
      display:flex;
      justify-content:center;
      align-items:center;
      transition:all .3s;
      box-shadow:0 5px 15px rgba(0,0,0,0.3);
      border: 1px solid #444;
    }
    .memory-item:hover {
      transform:scale(1.05); 
      box-shadow:0 10px 25px rgba(0,0,0,0.4); 
      z-index:2;
    }
    .memory-item img, .memory-item video {
      width:100%; 
      height:100%; 
      object-fit:cover; 
      transition:transform .3s;
    }
    h1 {
      font-family: 'Winky Rough', cursive; 
      font-size:2.2em; 
      color:#e84393;
      text-shadow:2px 2px 4px rgba(0,0,0,0.3); 
      margin:0;
      margin-bottom: 40px !important;
    }
    #bg-music, #tum-hi-ho-music { display:none; }
    .balloon, .confetti, .floating-heart { 
      position:absolute; 
      z-index:1; 
    }
    .balloon {
      width:50px;
      height:70px;
      border-radius:50%; 
      opacity:0;
      animation:float 8s ease-in-out infinite;
      box-shadow:inset -5px -5px 10px rgba(0,0,0,0.2);
    }
    .balloon:before {
      content:''; 
      position:absolute; 
      bottom:-40px; 
      left:50%; 
      width:2px;
      height:40px;
      background:#444; 
      transform:translateX(-50%);
    }
    @keyframes float {
      0%,100%{transform:translateY(0)}50%{transform:translateY(-40px) rotate(5deg);}
    }
    .balloon.red{background:radial-gradient(circle at 30% 30%,#ff6b6b,#e84393);}
    .balloon.blue{background:radial-gradient(circle at 30% 30%,#74b9ff,#0984e3);}
    .balloon.green{background:radial-gradient(circle at 30% 30%,#55efc4,#00b894);}
    .balloon.yellow{background:radial-gradient(circle at 30% 30%,#ffeaa7,#fdcb6e);}
    .balloon.purple{background:radial-gradient(circle at 30% 30%,#a29bfe,#6c5ce7);}
    .confetti {
      width:8px; 
      height:8px; 
      animation:confetti-fall 3s linear forwards;
    }
    @keyframes confetti-fall {
      0% { transform:translateY(-100vh); opacity:1; }
      100% { transform:translateY(100vh); opacity:0; }
    }
    .floating-heart {
      font-size:18px; 
      color:#ff6b6b; 
      animation:float-up 4s ease-in forwards;
    }
    @keyframes float-up {
      0% { transform:translateY(0); opacity:1; }
      100% { transform:translateY(-100vh) rotate(360deg); opacity:0; }
    }
    .party-overlay {
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(255,255,255,0.05);
      backdrop-filter:blur(2px);
      z-index:3;
      display:none;
      pointer-events:none;
    }
    .fade-in { animation:fadeIn 1s forwards; }
    .fade-out { animation:fadeOut 1s forwards; }
    @keyframes fadeIn {
      from { opacity:0; transform:translate(-50%,-50%) scale(.8); }
      to { opacity:1; transform:translate(-50%,-50%) scale(1); }
    }
    @keyframes fadeOut{
      from {opacity:1;}
      to {opacity:0;}
    }
    #start-overlay {
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: #121212;
  z-index: 9999;
  display:flex;
  justify-content:center;
  align-items:center;
  cursor:pointer;
  font-family: 'Rubik', sans-serif;
  font-size: 1.8em;
  color: #e84393;
  user-select:none;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
  font-weight: 500;
}
    @keyframes bounceFadeIn {
      0% {
        opacity: 0;
        transform: translateY(20px) scale(0.9);
      }
      50% {
        opacity: 1;
        transform: translateY(-10px) scale(1.05);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    #gift-button.show {
      display: inline-block;
      animation: bounceFadeIn 1s ease forwards;
      opacity: 1;
    }

    #wish-container {
      display: none;
      margin: 20px auto;
      max-width: 90%;
    }
    
    #wish-text {
      width: 100%;
      padding: 15px;
      border-radius: 15px;
      border: 1px solid #444;
      background: rgba(30,30,30,0.8);
      color: #e0e0e0;
      font-family: 'Montserrat', sans-serif;
      font-size: 1em;
      margin-bottom: 15px;
      resize: none;
      min-height: 100px;
    }
    
    #submit-wish {
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      background: linear-gradient(45deg, #e84393, #ff6b6b);
      color: white;
      font-weight: bold;
      font-size: 1.1em;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(255,107,107,0.3);
      margin: 0 auto;
      display: block;
    }
    
    #submit-wish:hover {
      background: linear-gradient(45deg, #ff6b6b, #e84393);
    }
    
    #wish-message {
      display: none;
      color: #ff6b6b;
      font-weight: bold;
      margin-top: 15px;
      text-align: center;
    }
    .cake-sparkle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: gold;
      border-radius: 50%;
      opacity: 0;
      animation: sparkle 2s ease-in-out infinite;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }
    
    .heart-pulse {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 4em;
      opacity: 0;
      z-index: 999;
      pointer-events: none;
      animation: heartPulse 2s ease-out forwards;
    }
    
    @keyframes heartPulse {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
      50% { opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(3); opacity: 0; }
    }
    
    @media (max-width: 600px) {
      h1 {
        font-size: 1.8em;
        margin-bottom: 30px !important;
      }
      .cake {
        width: 150px;
        height: 80px;
      }
      .cake:before {
        width: 170px;
      }
      .birthday-message {
        font-size: 1em;
        padding: 15px;
      }
      .memory-item {
        width: 130px;
        height: 130px;
      }
      .welcome-message {
        font-size: 2em;
      }
    }
    
    @media (max-width: 400px) {
      h1 {
        font-size: 1.5em;
        margin-bottom: 25px !important;
      }
      .memory-item {
        width: 100px;
        height: 100px;
      }
      #gift-button, #memories-button, #show-memories-button, #submit-wish {
        padding: 10px 20px;
        font-size: 1em;
      }
    }
    #bg-music, #tum-hi-ho-music { display:none; }
  </style>
</head>
<body>
  <div id="start-overlay">Tap to Start. Use headphone for better sound üéâ</div>
  <div class="container">
    <h1 id="typing-text">üë∏ Happy Birthday Prasansha!</h1>
    <div class="cake-container" id="cake-container" title="Click the cake to light the candle">
      <div class="candle"><div class="flame"></div></div>
      <div class="cake"></div>
    </div>
    <button id="gift-button">A simple gift for you</button>
    <button id="memories-button">Message</button>
    <div class="birthday-message" id="birthday-message"></div>
    <button id="show-memories-button">Memories</button>
    <div class="memory-gallery" id="memory-gallery"></div>
    
    <div id="wish-container">
      <textarea id="wish-text" placeholder="Type your wish here..."></textarea>
      <button id="submit-wish">Send Your Wish (3 left)</button>
      <p id="wish-message"></p>
    </div>
  </div>
  <div id="balloons-container"></div>
  <div class="party-overlay" id="party-overlay"></div>
  
  <div class="welcome-message" id="welcome-message-1">Hi Cutiepie</div>
  <div class="welcome-message" id="welcome-message-2">Gulumulu</div>
  <div class="welcome-message" id="welcome-message-3">Cupcake</div>
  <div class="welcome-message" id="welcome-message-4">Dumpling</div>
  <div class="welcome-message" id="welcome-message-5">I know it's unexpected</div>
  
  <div id="lightbox-modal" style="display:none; position:fixed;top:0;left:0;width:100vw;height:100vh; background:rgba(0,0,0,0.9); z-index:1000; justify-content:center; align-items:center; flex-direction: column;">
  <button id="lightbox-close" style="position:absolute;top:30px;right:30px; font-size:2em; background:rgba(30,30,30,0.8); border:none; color:white; cursor:pointer; width:50px; height:50px; border-radius:50%; display:flex; justify-content:center; align-items:center; z-index:1001; box-shadow: 0 0 15px rgba(0,0,0,0.5);">‚úñ</button>
  <button id="lightbox-prev" style="position:absolute;top:50%;left:30px; transform:translateY(-50%); font-size:2.5em; background:rgba(30,30,30,0.8); border:none; color:white; cursor:pointer; width:50px; height:50px; border-radius:50%; display:flex; justify-content:center; align-items:center; z-index:1001; box-shadow: 0 0 15px rgba(0,0,0,0.5);">‚óÄ</button>
  <div id="lightbox-content" style="max-width:90vw; max-height:85vh; display:flex; justify-content:center; align-items:center; position:relative;">
  </div>
  <button id="lightbox-next" style="position:absolute;top:50%;right:30px; transform:translateY(-50%); font-size:2.5em; background:rgba(30,30,30,0.8); border:none; color:white; cursor:pointer; width:50px; height:50px; border-radius:50%; display:flex; justify-content:center; align-items:center; z-index:1001; box-shadow: 0 0 15px rgba(0,0,0,0.5);">‚ñ∂</button>
</div>

<!-- Beautiful Final Messages -->
<!-- Page 1: Final Message -->
<div id="final-message" class="final-message-container">
  <button id="close-final-message" class="close-btn">‚úñ</button>
  <div class="message-box">
    <div class="message-content">
      <div class="message-title">No matter where life takes us...</div>
      <div class="message-body">
        Through all the changes, distances, and time that may pass between us...
      </div>
      <div class="message-highlight">
        You'll always be a special person in my heart üíü
      </div>
      <div class="message-footer">- Forever</div>
    </div>
  </div>
  <div class="floating-hearts" id="hearts-1"></div>
</div>

<!-- Page 2: Final Question -->
<div id="final-question" class="final-message-container">
  <button id="close-final-question" class="close-btn">‚úñ</button>
  <div class="message-box">
    <div class="message-content">
      <div class="message-title">Kya kabhi woh din wapas aa sakte hain...</div>
      <div class="message-body">
        Jab tum "haan ji" kehti thi aur har baat mein tumhari woh pyaari si muskurahat hoti thi?<br><br>
        Woh innocence, woh care, woh connection...<br>
        Kya woh sab wapas aa sakta hai?
      </div>
      <div class="message-highlight">
        Agar tumhe nahi lagta ki yeh possible hai...<br>
        Koi reply karne ki zarurat nahi hai üíî
      </div>
      <div class="message-body">
        Main samajh jaunga...<br>
        Aur main tumhe disturb nahi karunga<br>
        Chahe kitna bhi dard ho, main accept kar lunga
      </div>
      <div class="message-footer">Sometimes love means letting go when it's best for the person you loved from heart.</div>
    </div>
  </div>
  <div class="floating-hearts" id="hearts-2"></div>
</div>

<!-- Page 3: Final Message 2 -->
<div id="final-message-2" class="final-message-container">
  <button id="close-final-message-2" class="close-btn">‚úñ</button>
  <div class="message-box">
    <div class="message-content">
      <div class="message-title">Main jaanta hun hum alag countries, religion mein hain...</div>
      <div class="message-body">
        ...lekin keya iye sachme matter karta hey?<br><br>
        Pichle 649 din se har raat, main sochta raha...<br>
        kya ho sakta tha humara? eisa keya kar diya meyne jo tumhe bura lage?<br>
        Haa pata hey mey dikhen me sandar nehi hu, lekin.....
      </div>
      <div class="message-highlight">
        Agar kabhi tumhe lage ki "hum" firse try kar sakte hain...<br>
        main intezaar karunga ‚ù§Ô∏è pura jindegi bhar.
      </div>
    </div>
  </div>
  <div class="floating-hearts" id="hearts-3"></div>
</div>

<!-- Page 4: Final Message 3 - With Blur Effect -->
<div id="final-message-3" class="final-message-container">
  <button id="close-final-message-3" class="close-btn">‚úñ</button>
  <div class="message-box">
    <div class="message-content">
      <div class="message-title">Ek aur baat kehni thi...</div>
      <div class="message-body">
        <span class="blurred-text">
          Mey tumhara sara baate manunga.<br>
          Mey responsible ban jaaunga.<br>
          Khud ko pura change kar lunga.<br>
          Ek stable future banaunga.<br>
          Tumhe kabhi dukh nehi dunga.<br>
          Pura jindegi tumhara noukar jeysa rahunga. <br>
          Tumhara haat ka banaya hua khana khane ka bohot man karta hey.<br>
          Tumhara saath Splitsvilla dekhne ka bhi bohot maan karta hey mera.<br>
          Mujhe khudko saboot karne keliye sirf ek chance do Prasansha.. Sirf ek  üôÇ
        </span>
      </div>
    </div>
  </div>
  <div class="floating-hearts" id="hearts-4"></div>
</div>

  <audio id="bg-music" loop preload="auto">
    <source src="https://dl.dropboxusercontent.com/scl/fi/k4wo5sv2tetuos0zrcy21/audio.mp3?rlkey=ilhqqk19hlmw50iad0enp7vh3&dl=1" type="audio/mpeg"/>
  </audio>
  
  <!-- Tum Hi Ho Music Element -->
  <audio id="tum-hi-ho-music" preload="auto">
    <source src="https://dl.dropboxusercontent.com/scl/fi/j55hmo1c8mll6rgo0loak/Tum-Hi-Ho-Aashiqui-2-Karaoke-Version.m4a?rlkey=ggbeo5fpm66tr941b8dbp7thr&st=ra2ut3c9&dl=1" type="audio/mpeg"/>
  </audio>
  
  <script>
    // Mobile autoplay workaround
    document.addEventListener('DOMContentLoaded', function() {
      let audioUnlocked = false;
      
      const unlockAudio = () => {
        if (audioUnlocked) return;
        
        const bgMusic = document.getElementById('bg-music');
        const tumHiHoMusic = document.getElementById('tum-hi-ho-music');
        
        // Create a silent audio context to unlock audio on mobile
        const silentAudio = new Audio();
        silentAudio.src = 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==';
        silentAudio.volume = 0;
        
        silentAudio.play().then(() => {
          audioUnlocked = true;
          silentAudio.pause();
          silentAudio.remove();
        }).catch(() => {});
      };
      
      // Unlock audio on any user interaction
      document.addEventListener('click', unlockAudio);
      document.addEventListener('touchstart', unlockAudio);
      document.addEventListener('keydown', unlockAudio);
    });

    const startOverlay = document.getElementById('start-overlay');
    const giftButton = document.getElementById('gift-button');
    const cakeContainer = document.getElementById('cake-container');
    const candle = document.querySelector('.candle');
    const flame = document.querySelector('.flame');
    const memoriesButton = document.getElementById('memories-button');
    const birthdayMessage = document.getElementById('birthday-message');
    const showMemoriesButton = document.getElementById('show-memories-button');
    const memoryGallery = document.getElementById('memory-gallery');
    const bgMusic = document.getElementById('bg-music');
    const tumHiHoMusic = document.getElementById('tum-hi-ho-music');
    const finalMessage = document.getElementById('final-message');
    const closeFinalMessage = document.getElementById('close-final-message');
    const closeFinalQuestion = document.getElementById('close-final-question');
    const finalQuestion = document.getElementById('final-question');
    const finalMessage2 = document.getElementById('final-message-2');
    const closeFinalMessage2 = document.getElementById('close-final-message-2');
    const finalMessage3 = document.getElementById('final-message-3');
    const closeFinalMessage3 = document.getElementById('close-final-message-3');
    
    bgMusic.volume = 0.5;
    tumHiHoMusic.volume = 0;

    // Add error handling for audio
    bgMusic.addEventListener('error', function(e) {
      console.log('Background music failed to load');
    });

    tumHiHoMusic.addEventListener('error', function(e) {
      console.log('Tum Hi Ho music failed to load');
    });

    const lightboxModal = document.getElementById('lightbox-modal');
    const lightboxContent = document.getElementById('lightbox-content');
    const lightboxClose = document.getElementById('lightbox-close');
    const lightboxNext = document.getElementById('lightbox-next');
    const lightboxPrev = document.getElementById('lightbox-prev');

    const wishContainer = document.getElementById('wish-container');
    const wishText = document.getElementById('wish-text');
    const submitWish = document.getElementById('submit-wish');
    const wishMessage = document.getElementById('wish-message');

    const welcomeMessages = [
      document.getElementById('welcome-message-1'),
      document.getElementById('welcome-message-2'),
      document.getElementById('welcome-message-3'),
      document.getElementById('welcome-message-4'),
      document.getElementById('welcome-message-5')
    ];

    let currentIndex = 0;
    let balloonsActive = false;
    let wishCount = 3;

    const memories = [
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/jwr4vspirerbzz4dc74da/IMG-20250718-WA0060.jpg?rlkey=ji352spt12i6momseziz49080&st=zfss0noo&dl=1' },
      { type: 'video', url: 'https://dl.dropboxusercontent.com/scl/fi/05l3vcsvgebwen673ra27/VID-20250718-WA0018.mp4?rlkey=lkeuttwo68l2p7c48u8a72ykh&st=pu4hrzpa&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/603qdagaor5u3ek10tjs6/IMG-20250718-WA0061.jpg?rlkey=8ugmvmekjk2pwacynhwrw9lb9&st=87z4hskz&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/lngj4243ahoqeg750c46o/IMG-20250718-WA0059.jpg?rlkey=2h4e4nzzx57rivf42mo5ae44m&st=0mzb1ckf&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/uiot74i488yuhwaq2p0jl/IMG-20250718-WA0058.jpg?rlkey=hj8rhkpxt7slzsy56i6b3r8no&st=fjetct7a&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/li3fvkj4z9ksea6w8ed8j/IMG-20250718-WA0057.jpg?rlkey=8s7z3eol4e3azvva48anjeybo&st=ybojoaie&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/l8ypf8o3c02evlmk5p68u/IMG_20251101_235252_485.jpg?rlkey=xokyjg9396vral1r9wn26emq5&st=hjl3n27s&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/0j8dopua4x3qudgmb24d0/IMG_20251101_235246_563.jpg?rlkey=8c97s098e1gwyshwtld3am3nz&st=zrpvxok1&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/uou6riqsfjpn6cgpaivd6/IMG_20251101_235243_458.jpg?rlkey=kp8e1sdvyjgvphv51pe6u06ga&st=h41ybcmv&dl=1' },
      { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/3hqion58o3t5s0q3e3y6b/IMG_20251101_235239_710.jpg?rlkey=eqspt6rb8hycotf7ilipg4ejc&st=ugeltzsp&dl=1' }
    ];

    const memoryCaptions = [
      "That look‚Ä¶ I could get lost in it forever üåπ",
      "Jab tum lip-sync karti ho, har ek lafz tumhari smile se aur bhi magical lagta hai‚Ä¶ üéµüíñ",
      "Yess‚Ä¶ That face, that smile‚Ä¶ Har photo mein tumhari khubsurti aur pyar mujhe mehsoos hota hai, jaise duniya ki har khoobsurti tumhare andar hi base ho ‚ù§Ô∏èüå∏",
      "Chhoti si masti, par har expression mein tumhari khubsurti aur pyaar nazar aata hai‚Ä¶ har photo ek yaad, har yaad ek feeling ‚ù§Ô∏èüêæ",
      "Red hair, twinkling smile, aur woh cute effect‚Ä¶ bas tum hi ho jo mujhe hamesha khus rehne par majboor kar deti ho",
      "Woh khula aasman aur tum‚Ä¶ jaise duniya ke saare stars bas tumhari hi taraf dekh rahe ho ‚ú®üíñ. Piche dekho, mujhe dikh raha hai‚Ä¶ wo cows, waise main hi hoon üòÑüêÑ",
      "Koi itni cute aur beautiful ek saath kaise ho sakti hai? üíì",
      "Bas tumhari aankhon mein kho jaane ka mann karta hai‚Ä¶ jaise duniya thodi si silent ho jaaye aur sirf tum aur ye pal rahe ‚ú®üñ§",
      "Har photo mein tumhari ek alag charm hai‚Ä¶ jaise tum khud ek little universe ho üå∏üåü",
      "Perfection exists, aur main use dekh raha hoon üåü"
    ];

    // Function to create floating hearts
    function createFloatingHearts(containerId, count = 15) {
      const container = document.getElementById(containerId);
      if (!container) return;
      
      for (let i = 0; i < count; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.innerHTML = '‚ù§Ô∏è';
        heart.style.left = Math.random() * 100 + '%';
        heart.style.animationDelay = Math.random() * 6 + 's';
        heart.style.fontSize = (Math.random() * 15 + 15) + 'px';
        container.appendChild(heart);
      }
    }

    // Function to show final message with animation
    function showFinalMessage(messageElement) {
      messageElement.style.display = 'flex';
      setTimeout(() => {
        const messageBox = messageElement.querySelector('.message-box');
        if (messageBox) {
          messageBox.classList.add('show');
        }
      }, 100);
    }

    // Function to hide final message with animation
    function hideFinalMessage(messageElement, callback) {
      const messageBox = messageElement.querySelector('.message-box');
      if (messageBox) {
        messageBox.classList.remove('show');
      }
      setTimeout(() => {
        messageElement.style.display = 'none';
        if (callback) callback();
      }, 800);
    }

    // Page 1 ‚Üí Page 2
    closeFinalMessage.addEventListener('click', function() {
      hideFinalMessage(finalMessage, function() {
        createFloatingHearts('hearts-2');
        showFinalMessage(finalQuestion);
        createHeartPulse();
      });
    });

    // Page 2 ‚Üí Page 3
    closeFinalQuestion.addEventListener('click', function() {
      hideFinalMessage(finalQuestion, function() {
        createFloatingHearts('hearts-3');
        showFinalMessage(finalMessage2);
        createHeartPulse();
      });
    });

    // Page 3 ‚Üí Page 4
    closeFinalMessage2.addEventListener('click', function() {
      hideFinalMessage(finalMessage2, function() {
        createFloatingHearts('hearts-4');
        showFinalMessage(finalMessage3);
        createHeartPulse();
      });
    });

    // Page 4 ‚Üí Close Everything
    closeFinalMessage3.addEventListener('click', function() {
      hideFinalMessage(finalMessage3, function() {
        // End of journey
        createHeartPulse();
      });
    });

    // Add click event to blurred text
    document.addEventListener('DOMContentLoaded', function() {
      const blurredText = document.querySelector('.blurred-text');
      if (blurredText) {
        blurredText.addEventListener('click', function() {
          this.style.filter = 'blur(0)';
          this.style.cursor = 'default';
        });
        
        // For mobile touch
        blurredText.addEventListener('touchstart', function() {
          this.style.filter = 'blur(0)';
          this.style.cursor = 'default';
        });
      }
    });

    function createHeartPulse() {
      const heart = document.createElement('div');
      heart.className = 'heart-pulse';
      heart.textContent = 'üíü';
      document.body.appendChild(heart);
      
      setTimeout(() => {
        if (document.body.contains(heart)) {
          document.body.removeChild(heart);
        }
      }, 2000);
    }

    function openLightbox(index) {
      currentIndex = index;
      showMedia(currentIndex);
      lightboxModal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
      lightboxModal.style.display = 'none';
      lightboxContent.innerHTML = '';
      document.body.style.overflow = '';
      
      // Always restore music volume when lightbox closes
      bgMusic.volume = 0.5;
    }

    function showMedia(index) {
      const mem = memories[index];
      lightboxContent.innerHTML = '';

      // Create container for media and caption
      const mediaContainer = document.createElement('div');
      mediaContainer.style.display = 'flex';
      mediaContainer.style.flexDirection = 'column';
      mediaContainer.style.alignItems = 'center';
      mediaContainer.style.justifyContent = 'center';
      mediaContainer.style.maxWidth = '90vw';
      mediaContainer.style.maxHeight = '90vh';

      if(mem.type === 'image') {
        const img = document.createElement('img');
        img.src = mem.url;
        img.style.maxHeight = '70vh';
        img.style.maxWidth = '80vw';
        img.style.borderRadius = '10px';
        img.style.boxShadow = '0 0 20px rgba(255, 255, 255, 0.2)';
        img.onerror = function() {
          this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iIzMzMyIvPjx0ZXh0IHg9IjE1MCIgeT0iMTUwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+SW1hZ2UgTm90IEZvdW5kPC90ZXh0Pjwvc3ZnPg==';
        };
        mediaContainer.appendChild(img);
      } else if(mem.type === 'video') {
        const vid = document.createElement('video');
        vid.src = mem.url;
        vid.controls = true;
        vid.autoplay = false; // Don't autoplay, let user click to play
        vid.style.maxHeight = '70vh';
        vid.style.maxWidth = '80vw';
        vid.style.borderRadius = '10px';
        vid.style.boxShadow = '0 0 20px rgba(255, 255, 255, 0.2)';
        
        // Lower site music when video starts playing
        vid.addEventListener('play', function() {
          bgMusic.volume = 0.1; // Lower background music volume
        });
        
        // Restore site music when video is paused or ends
        vid.addEventListener('pause', function() {
          bgMusic.volume = 0.5; // Restore normal volume
        });
        
        vid.addEventListener('ended', function() {
          bgMusic.volume = 0.5; // Restore normal volume when video ends
        });
        
        mediaContainer.appendChild(vid);
      }

      // ADD CAPTION TO LIGHTBOX
      if (memoryCaptions[index]) {
        const caption = document.createElement('div');
        caption.className = 'lightbox-caption';
        caption.textContent = memoryCaptions[index];
        caption.style.cssText = 'color: #e84393; font-size: 1.2em; margin-top: 20px; text-align: center; font-style: italic; padding: 15px; line-height: 1.4; background: rgba(232, 67, 147, 0.1); border-radius: 15px; border: 1px solid rgba(232, 67, 147, 0.3); max-width: 80%;';
        mediaContainer.appendChild(caption);
      }

      lightboxContent.appendChild(mediaContainer);
    }

    function nextMedia() {
      currentIndex = (currentIndex + 1) % memories.length;
      showMedia(currentIndex);
    }

    function prevMedia() {
      currentIndex = (currentIndex - 1 + memories.length) % memories.length;
      showMedia(currentIndex);
    }

    function setupMemoryClicks() {
      const items = memoryGallery.querySelectorAll('.memory-item');
      items.forEach((item, i) => {
        item.style.cursor = 'pointer';
        item.onclick = () => openLightbox(i);
      });
    }

    lightboxClose.onclick = closeLightbox;
    lightboxNext.onclick = nextMedia;
    lightboxPrev.onclick = prevMedia;

    function loadMemories() {
      if (memoryGallery.children.length > 0) return;
      memories.forEach(mem => {
        const div = document.createElement('div');
        div.className = 'memory-item';
        if (mem.type === 'image') {
          const img = document.createElement('img');
          img.src = mem.url;
          img.alt = 'Memory image';
          img.onerror = function() {
            this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iIzMzMyIvPjx0ZXh0IHg9Ijc1IiB5PSI3NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4=';
          };
          div.appendChild(img);
        } else if (mem.type === 'video') {
          const vid = document.createElement('video');
          vid.src = mem.url;
          vid.controls = false;
          vid.muted = true;
          vid.loop = true;
          vid.autoplay = true;
          div.appendChild(vid);
        }
        memoryGallery.appendChild(div);
      });

      setupMemoryClicks();
      
      setTimeout(() => {
        wishContainer.style.display = 'block';
        wishContainer.style.opacity = '0';
        setTimeout(() => {
          wishContainer.style.transition = 'opacity 1s ease';
          wishContainer.style.opacity = '1';
        }, 100);
      }, 500);
    }

    const balloonsContainer = document.getElementById('balloons-container');
    const partyOverlay = document.getElementById('party-overlay');
    const typingText = document.getElementById('typing-text');
    const fullText = 'üëë Happy Birthday Prasansha! ‚ú®üíì';
    let charIndex = 0;
    let started = false;

    startOverlay.onclick = () => {
      if (started) return;
      started = true;
      startOverlay.style.display = 'none';
      
      // Mobile-friendly audio play with error handling and fade in
      const playAudio = () => {
        bgMusic.volume = 0; // Start with volume 0
        bgMusic.play().then(() => {
          console.log("Birthday music started - fading in");
          
          // Fade in audio over 1 second
          let volume = 0;
          const fadeInInterval = setInterval(() => {
            volume += 0.05; // Increase volume gradually
            if (volume >= 0.5) {
              volume = 0.5; // Final volume
              clearInterval(fadeInInterval);
              console.log("Audio fade in complete");
            }
            bgMusic.volume = volume;
          }, 50); // Update every 50ms for smooth fade (20 steps over 1 second)
          
        }).catch(error => {
          console.log("Audio play failed, retrying...", error);
          // Retry after user interaction
          document.addEventListener('click', function retryPlay() {
            bgMusic.play();
            document.removeEventListener('click', retryPlay);
          }, { once: true });
        });
      };
      
      playAudio();
      showWelcomeMessages();
    };

    function showWelcomeMessages() {
      document.querySelector('.container').style.opacity = '0';

      welcomeMessages.forEach((message, index) => {
        setTimeout(() => {
          message.classList.add('fade-in');
          setTimeout(() => {
            message.classList.replace('fade-in', 'fade-out');
            
            if (index === welcomeMessages.length - 1) {
              setTimeout(() => {
                document.querySelector('.container').style.opacity = '1';
                typeWriter();
              }, 1000);
            }
          }, 1000);
        }, index * 1500);
      });
    }

    function typeWriter() {
      if (charIndex < fullText.length) {
        typingText.textContent = fullText.slice(0, charIndex + 1);
        charIndex++;
        setTimeout(typeWriter, 120);
      } else {
        typingText.style.borderRight = 'none';
        setTimeout(() => {
          giftButton.classList.add('show');
        }, 1000);
      }
    }

    function createBalloons(count) {
      for (let i = 0; i < count; i++) {
        const balloon = document.createElement('div');
        balloon.classList.add('balloon');
        const colors = ['red', 'blue', 'green', 'yellow', 'purple'];
        balloon.classList.add(colors[i % colors.length]);
        balloon.style.left = Math.random() * 100 + 'vw';
        balloon.style.animationDelay = Math.random() * 5 + 's';
        balloon.style.opacity = '1';
        balloonsContainer.appendChild(balloon);
      }
      balloonsActive = true;
    }

    function createConfetti() {
      const confetti = document.createElement('div');
      confetti.classList.add('confetti');
      confetti.style.left = Math.random() * 100 + 'vw';
      confetti.style.background = `hsl(${Math.random() * 360}, 70%, 60%)`;
      balloonsContainer.appendChild(confetti);
      setTimeout(() => {
        if (balloonsContainer.contains(confetti)) {
          balloonsContainer.removeChild(confetti);
        }
      }, 3000);
    }

    function createFloatingHearts() {
      const heart = document.createElement('div');
      heart.classList.add('floating-heart');
      heart.textContent = '‚ù§Ô∏è';
      heart.style.left = Math.random() * 100 + 'vw';
      balloonsContainer.appendChild(heart);
      setTimeout(() => {
        if (balloonsContainer.contains(heart)) {
          balloonsContainer.removeChild(heart);
        }
      }, 4000);
    }

    function openGift() {
      document.body.style.backgroundColor = '#1a1a1a';
      giftButton.style.display = 'none';
      cakeContainer.style.display = 'block';
      createBalloons(12);
      createConfetti();
      createFloatingHearts();
      partyOverlay.style.display = 'block';
      
      // Add cake sparkles
      for(let i = 0; i < 8; i++) {
        createCakeSparkle();
      }
      
      // Shooting stars occasionally
      setInterval(() => {
        if(Math.random() > 0.8) {
          createShootingStar();
        }
      }, 5000);
      
      // Other effects
      setInterval(() => { 
        createConfetti(); 
        createFloatingHearts(); 
      }, 3000);
      
      setTimeout(() => { 
        memoriesButton.style.display = 'inline-block'; 
        createHeartPulse();
      }, 1000);
    }

    function createCakeSparkle() {
      const sparkle = document.createElement('div');
      sparkle.className = 'cake-sparkle';
      const cakeRect = cakeContainer.getBoundingClientRect();
      sparkle.style.left = (Math.random() * 180 - 90) + cakeRect.left + 'px';
      sparkle.style.top = (Math.random() * 100 - 50) + cakeRect.top + 'px';
      sparkle.style.animationDelay = Math.random() * 2 + 's';
      document.body.appendChild(sparkle);
    }

    function lightCandle() {
      flame.classList.add('burning');
      createConfetti();
      createHeartPulse();
    }

    function typeText(element, text, speed, callback) {
      let i = 0;
      element.textContent = '';
      element.style.display = 'block';
      function typeNext() {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          setTimeout(typeNext, speed);
        } else if (callback) {
          callback();
        }
      }
      typeNext();
    }

    function fadeInTumHiHo() {
      console.log("Starting Tum Hi Ho fade in...");
      
      // Reset and prepare Tum Hi Ho
      tumHiHoMusic.currentTime = 0;
      tumHiHoMusic.volume = 0;
      
      const playTumHiHo = () => {
        tumHiHoMusic.play().then(() => {
          console.log("Tum Hi Ho started successfully");
          
          // Fade in Tum Hi Ho gradually
          let volume = 0;
          const fadeInInterval = setInterval(() => {
            volume += 0.02;
            if (volume >= 0.6) {
              volume = 0.6;
              clearInterval(fadeInInterval);
              console.log("Tum Hi Ho fade in complete");
            }
            tumHiHoMusic.volume = volume;
          }, 150);
          
        }).catch(error => {
          console.log("Tum Hi Ho play failed:", error);
          // Retry after user interaction
          document.addEventListener('click', function retryTumHiHo() {
            tumHiHoMusic.play();
            document.removeEventListener('click', retryTumHiHo);
          }, { once: true });
        });
      };
      
      // Start playing
      playTumHiHo();
    }

    // 3-Wish limit functionality
    submitWish.addEventListener('click', function() {
      const wish = wishText.value.trim();
      if (wish && wishCount > 0) {
        const botToken = '8233623504:AAHOce1na68q9d8IZNnA8WE_Ca_eL19CTSs';
        const chatId = '6643918586';
        const message = `üíå Wish ${4 - wishCount} from Prasansha:\n"${wish}"`;
        
        // Show loading state
        const originalText = submitWish.textContent;
        submitWish.textContent = 'Sending...';
        submitWish.disabled = true;
        
        fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ 
            chat_id: chatId, 
            text: message
          })
        })
        .then(response => response.json())
        .then(data => {
          console.log('Telegram response:', data);
          wishCount--;
          
          if (wishCount > 0) {
            wishMessage.textContent = `‚ú® Your wish has been sent to the universe! ${wishCount} wish${wishCount > 1 ? 'es' : ''} remaining.`;
            submitWish.textContent = `Send Your Wish (${wishCount} left)`;
            wishMessage.style.display = 'block';
            wishText.value = '';
            
            for (let i = 0; i < 20; i++) setTimeout(() => createConfetti(), i * 100);
            createHeartPulse();
          } else {
            // ALL WISHES COMPLETED - This part should trigger the final message
            wishMessage.textContent = "All your wishes have been sent to the universe ‚ú®\n\nYour wishes are now traveling among the stars...";
            submitWish.style.display = 'none';
            wishText.disabled = true;
            wishText.placeholder = "Your 3 wishes have been sent to the universe ‚ú®";
            wishMessage.style.display = 'block';
            wishText.value = '';
            
            // Create erasing overlay
            const erasingOverlay = document.createElement('div');
            erasingOverlay.style.position = 'fixed';
            erasingOverlay.style.top = '0';
            erasingOverlay.style.left = '0';
            erasingOverlay.style.width = '100%';
            erasingOverlay.style.height = '0%';
            erasingOverlay.style.background = '#121212';
            erasingOverlay.style.zIndex = '1999';
            erasingOverlay.style.transition = 'height 3s ease-in-out';
            document.body.appendChild(erasingOverlay);
            
            // Start erasing effect and music fade out after 2 seconds
            setTimeout(() => {
              // Start music fade out
              let volume = 0.5;
              const fadeAudio = setInterval(() => {
                volume -= 0.05;
                if (volume <= 0) {
                  bgMusic.volume = 0;
                  bgMusic.pause(); // Stop the birthday music
                  clearInterval(fadeAudio);
                  
                  // Start fading in Tum Hi Ho when birthday music fades out
                  setTimeout(fadeInTumHiHo, 500);
                } else {
                  bgMusic.volume = volume;
                }
              }, 300);
              
              // Start erasing from top to bottom
              erasingOverlay.style.height = '100%';
              
              // After erasing completes, show final message
              setTimeout(() => {
                // Hide everything
                document.querySelector('.container').style.display = 'none';
                balloonsContainer.style.display = 'none';
                partyOverlay.style.display = 'none';
                erasingOverlay.style.display = 'none';
                
                // Show final message with beautiful animation
                createFloatingHearts('hearts-1');
                showFinalMessage(finalMessage);
                createHeartPulse();
                
                // Final celebration
                for (let i = 0; i < 100; i++) setTimeout(() => createConfetti(), i * 50);
                for (let i = 0; i < 20; i++) setTimeout(() => createFloatingHearts(), i * 200);
                
              }, 3000); // Erasing duration
              
            }, 2000); // Initial delay before erasing starts
          }
        })
        .catch(error => {
          console.error('Error:', error);
          // Even if there's an error, still continue with the flow
          wishCount--;
          
          if (wishCount > 0) {
            wishMessage.textContent = `‚ú® Your wish has been sent to the universe! ${wishCount} wish${wishCount > 1 ? 'es' : ''} remaining.`;
            submitWish.textContent = `Send Your Wish (${wishCount} left)`;
          } else {
            wishMessage.textContent = "All your wishes have been sent to the universe ‚ú®\n\nYour wishes are now traveling among the stars...";
            submitWish.style.display = 'none';
            wishText.disabled = true;
            wishText.placeholder = "Your 3 wishes have been sent to the universe ‚ú®";
            
            // Trigger final message sequence even if Telegram fails
            setTimeout(() => {
              const erasingOverlay = document.createElement('div');
              erasingOverlay.style.position = 'fixed';
              erasingOverlay.style.top = '0';
              erasingOverlay.style.left = '0';
              erasingOverlay.style.width = '100%';
              erasingOverlay.style.height = '0%';
              erasingOverlay.style.background = '#121212';
              erasingOverlay.style.zIndex = '1999';
              erasingOverlay.style.transition = 'height 3s ease-in-out';
              document.body.appendChild(erasingOverlay);
              
              setTimeout(() => {
                let volume = 0.5;
                const fadeAudio = setInterval(() => {
                  volume -= 0.05;
                  if (volume <= 0) {
                    bgMusic.volume = 0;
                    bgMusic.pause();
                    clearInterval(fadeAudio);
                    setTimeout(fadeInTumHiHo, 500);
                  } else {
                    bgMusic.volume = volume;
                  }
                }, 300);
                
                erasingOverlay.style.height = '100%';
                
                setTimeout(() => {
                  document.querySelector('.container').style.display = 'none';
                  balloonsContainer.style.display = 'none';
                  partyOverlay.style.display = 'none';
                  erasingOverlay.style.display = 'none';
                  
                  createFloatingHearts('hearts-1');
                  showFinalMessage(finalMessage);
                  createHeartPulse();
                  for (let i = 0; i < 100; i++) setTimeout(() => createConfetti(), i * 50);
                  for (let i = 0; i < 20; i++) setTimeout(() => createFloatingHearts(), i * 200);
                }, 3000);
              }, 2000);
            }, 1000);
          }
          wishMessage.style.display = 'block';
          wishText.value = '';
          
          for (let i = 0; i < 20; i++) setTimeout(() => createConfetti(), i * 100);
          createHeartPulse();
        })
        .finally(() => {
          submitWish.disabled = false;
        });
      }
    });

    giftButton.addEventListener('click', openGift);
    cakeContainer.addEventListener('click', () => {
      if (!flame.classList.contains('burning')) {
        lightCandle();
      }
    });

    memoriesButton.addEventListener('click', () => {
      memoriesButton.style.display = 'none';
      birthdayMessage.style.display = 'block';
      birthdayMessage.textContent = '';
      const message = "Happy Birthday Prasansha! üéâüíñ\n\nTum hamesha khush raho, healthy raho, aur waise hi pyaari aur adorable chubby doll jeysa bane raho jaise tum ho. Tum waise hi perfect ho.\n\nMujhe pata hai, maine pehle immature behave kiya jo zyada ho gaya tha ‚Äî reels, messages, comments‚Ä¶ sab kuch. Sayad mere iye sab bhi jyada hi ho rahahey.\n\nFor that, I'm truly sorry.\n\nPlease maaf kar dena.\n\n Take care. Dua karta hu khus raho hamesha.... üåë";

      typeText(birthdayMessage, message, 40, () => {
        showMemoriesButton.style.display = 'inline-block';
        createHeartPulse();
      });
    });

    showMemoriesButton.addEventListener('click', () => {
      birthdayMessage.style.display = 'block';
      birthdayMessage.textContent = '';
      memoryGallery.style.display = 'none';
      
      const treasureMessage = "Maine ye photos ab tak sambhal ke rakhi hain. Na ki isliye ki kuch badal sakun, par kyunki ye tumhara ek hissa hain jo main bhool nahi sakta. Ab bhi, rooj inhe dekhta hu. Pura din accha jaata hey tumhe yaad karke üíõ";
      
      birthdayMessage.textContent = '';
      birthdayMessage.style.display = 'block';
      
      typeText(birthdayMessage, treasureMessage, 40, () => {
        memoryGallery.style.display = 'flex';
        loadMemories();
      });
    });

    function createShootingStar() {
      const star = document.createElement('div');
      star.className = 'shooting-star';
      star.style.left = Math.random() * 20 + 'vw';
      star.style.top = Math.random() * 30 + 'vh';
      star.style.animationDuration = (Math.random() * 2 + 2) + 's';
      document.body.appendChild(star);
      
      setTimeout(() => {
        if (document.body.contains(star)) {
          document.body.removeChild(star);
        }
      }, 3000);
    }
  </script>
</body>
</html>
