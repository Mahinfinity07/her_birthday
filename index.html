<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>For Prasansha üíñ</title>
    <style>
        /* === MOBILE FIRST - NO SHAKES === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            background: linear-gradient(145deg, #fff0f5, #fff5f7);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #5a3d5c;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }
        
        /* === START SCREEN === */
        #start-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ffb6c1, #dda0dd);
            z-index: 3000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            text-align: center;
            color: white;
            font-size: 1.8em;
            font-weight: 600;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        
        /* === BLACK SCREEN === */
        .black-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            z-index: 5000;
            pointer-events: none;
            opacity: 0;
        }
        
        /* === FIXED HEADER === */
        #happy-birthday-text {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            text-align: center;
            z-index: 1000;
            border-bottom: 2px solid #ffb6c1;
            box-shadow: 0 4px 20px rgba(232, 67, 147, 0.1);
            display: none;
        }
        
        #typing-text {
            font-size: 1.8em;
            color: #e84393;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        /* === MAIN LAYOUT === */
        .center-vertically {
            width: 100%;
            min-height: calc(100vh - 40px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px 0;
        }
        
        .content-wrapper {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-bottom: 40px;
        }
        
        /* === GIFT BUTTON === */
        #gift-button {
            display: none;
            padding: 18px 40px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, #ff85a2, #e84393);
            color: white;
            font-size: 1.3em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(232, 67, 147, 0.3);
            margin: 30px 0;
            width: 90%;
            max-width: 300px;
            transition: transform 0.2s ease;
        }
        
        #gift-button.show {
            display: block;
            animation: popIn 0.5s ease forwards;
        }
        
        #gift-button:active {
            transform: scale(0.98);
        }
        
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        /* === CAKE === */
        .cake-container {
            display: none;
            margin: 30px 0;
            position: relative;
            cursor: pointer;
            touch-action: manipulation;
        }
        
        .cake {
            width: 180px;
            height: 90px;
            background: linear-gradient(to bottom, #fff5f7, #ffb6c1);
            border-radius: 15px 15px 0 0;
            position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .cake::before {
            content: '';
            position: absolute;
            top: -12px;
            left: -8px;
            width: 196px;
            height: 20px;
            background: linear-gradient(to right, #ff85a2, #dda0dd);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .candle {
            width: 8px;
            height: 40px;
            background: linear-gradient(to bottom, white, #fff9c4);
            position: absolute;
            top: -45px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .flame {
            width: 12px;
            height: 25px;
            background: radial-gradient(circle, #ffd700 20%, orange 70%);
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            border-radius: 50% 50% 20% 20%;
            filter: blur(1px);
            transition: opacity 0.3s ease;
        }
        
        .flame.burning {
            opacity: 1;
            animation: flicker 0.5s infinite alternate;
        }
        
        @keyframes flicker {
            0%, 100% { transform: translateX(-50%) scale(1); opacity: 0.9; }
            50% { transform: translateX(-50%) scale(1.1); opacity: 1; }
        }
        
        /* === ACTION BUTTONS === */
        #memories-button,
        #show-memories-button {
            display: none;
            padding: 16px 35px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, #dda0dd, #b19cd9);
            color: white;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(177, 156, 217, 0.3);
            margin: 15px 0;
            width: 90%;
            max-width: 280px;
            transition: transform 0.2s ease;
        }
        
        #memories-button:active,
        #show-memories-button:active {
            transform: scale(0.98);
        }
        
        /* === SIMPLE MESSAGE BOX (White box for "If You Ever Want To") === */
        .simple-message-box {
            background: white;
            border-radius: 15px;
            padding: 25px 20px;
            margin: 20px 0;
            width: 95%;
            max-width: 350px;
            border: 2px solid #e0e0e0;
            line-height: 1.6;
            text-align: left;
            white-space: pre-wrap;
            display: none;
            
            /* Scrolling with proper text display */
            max-height: 200px;
            height: 200px;
            overflow-y: auto;
            word-wrap: break-word;
            
            /* Simple styling */
            color: #333;
            font-size: 0.95em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        .simple-message-box::-webkit-scrollbar {
            width: 4px;
        }
        
        .simple-message-box::-webkit-scrollbar-track {
            background: #f5f5f5;
            border-radius: 10px;
        }
        
        .simple-message-box::-webkit-scrollbar-thumb {
            background: #dda0dd;
            border-radius: 10px;
        }
        
        /* === WISH SECTION (For sending messages to Telegram) === */
        #wish-container {
            display: none;
            width: 100%;
            max-width: 350px;
            margin: 25px 0;
        }
        
        #wish-text {
            width: 100%;
            padding: 18px;
            border-radius: 15px;
            border: 2px solid rgba(255, 182, 193, 0.5);
            background: rgba(255, 255, 255, 0.95);
            color: #5a3d5c;
            font-family: inherit;
            font-size: 1em;
            margin-bottom: 15px;
            resize: none;
            min-height: 120px;
            outline: none;
        }
        
        #submit-wish {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #0088cc, #34b7f1);
            color: white;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 136, 204, 0.3);
            transition: transform 0.2s ease;
            width: 100%;
        }
        
        #submit-wish:active {
            transform: scale(0.98);
        }
        
        #submit-wish:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        #wish-message {
            display: none;
            color: #0088cc;
            font-weight: 600;
            margin-top: 15px;
            text-align: center;
            font-size: 1em;
        }
        
        /* === VOICE MESSAGES SECTION === */
        #voice-messages-container {
            display: none;
            width: 100%;
            max-width: 350px;
            margin: 25px 0;
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .voice-messages-title {
            text-align: center;
            color: #e84393;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(232, 67, 147, 0.2);
        }
        
        .voice-message-item {
            margin-bottom: 25px;
            background: rgba(255, 245, 247, 0.5);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 182, 193, 0.2);
        }
        
        .voice-player {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        .voice-play-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #ff85a2, #e84393);
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: transform 0.2s ease;
        }
        
        .voice-play-btn:active {
            transform: scale(0.95);
        }
        
        .voice-play-btn.playing {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
        }
        
        .voice-progress {
            flex: 1;
            height: 6px;
            background: rgba(232, 67, 147, 0.2);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .voice-progress-bar {
            height: 100%;
            background: linear-gradient(to right, #ff85a2, #e84393);
            width: 0%;
            transition: width 0.1s linear;
        }
        
        .voice-time {
            font-size: 0.85em;
            color: #888;
            min-width: 50px;
            text-align: right;
        }
        
        .voice-caption-input {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(255, 182, 193, 0.5);
            background: white;
            font-family: inherit;
            font-size: 0.95em;
            color: #5a3d5c;
            resize: none;
            min-height: 60px;
            outline: none;
            transition: border-color 0.3s ease;
        }
        
        .voice-caption-input:focus {
            border-color: #ff85a2;
        }
        
        /* === MEMORIES GALLERY === */
        .memory-gallery {
            display: none;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
            width: 100%;
            max-width: 350px;
        }
        
        .memory-item {
            width: 100%;
            aspect-ratio: 1;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 3px solid white;
            position: relative;
        }
        
        .memory-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            padding: 3px;
            background: linear-gradient(135deg, #ff85a2, #dda0dd);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }
        
        .memory-item img,
        .memory-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
        }
        
        /* === LIGHTBOX === */
        #lightbox-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .lightbox-media-container {
            width: 100%;
            max-height: 60vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        
        #lightbox-media {
            max-width: 100%;
            max-height: 60vh;
            border-radius: 15px;
            object-fit: contain;
        }
        
        #lightbox-prev,
        #lightbox-next {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 2.5em;
            cursor: pointer;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2001;
            backdrop-filter: blur(10px);
            -webkit-tap-highlight-color: transparent;
        }
        
        #lightbox-prev {
            left: 15px;
        }
        
        #lightbox-next {
            right: 15px;
        }
        
        #lightbox-close {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 1.8em;
            cursor: pointer;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2001;
            backdrop-filter: blur(10px);
        }
        
        .lightbox-caption {
            color: white;
            font-size: 1.1em;
            text-align: center;
            padding: 15px;
            line-height: 1.4;
            background: rgba(232, 67, 147, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(232, 67, 147, 0.4);
            width: 90%;
            max-height: 20vh;
            overflow-y: auto;
            word-wrap: break-word;
            margin-top: 10px;
        }
        
        /* === WELCOME MESSAGES === */
        .welcome-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5em;
            color: #e84393;
            opacity: 0;
            z-index: 100;
            pointer-events: none;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-weight: 700;
        }
        
        /* === FINAL MESSAGES CONTAINER === */
        .final-message-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 245, 247, 0.98);
            z-index: 4000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .message-box {
            background: white;
            border-radius: 20px;
            padding: 25px;
            width: 95%;
            max-width: 350px;
            box-shadow: 0 20px 50px rgba(232, 67, 147, 0.2);
            border: 2px solid rgba(255, 182, 193, 0.4);
            position: relative;
            transform: translateY(30px);
            opacity: 0;
            transition: all 0.6s ease;
        }
        
        .message-box.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .message-content {
            color: #5a3d5c;
            line-height: 1.6;
            text-align: center;
        }
        
        .message-title {
            font-size: 1.4em;
            color: #e84393;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .message-body {
            font-size: 1em;
            margin-bottom: 15px;
        }
        
        .message-highlight {
            font-size: 1.1em;
            color: #e84393;
            font-weight: 500;
            margin: 15px 0;
            line-height: 1.5;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 182, 193, 0.2);
            border: 1px solid rgba(255, 182, 193, 0.4);
            color: #e84393;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .close-btn:active {
            transform: scale(0.95);
        }
        
        .blurred-text {
            filter: blur(5px);
            transition: filter 0.3s ease;
            cursor: pointer;
            background: rgba(255, 245, 247, 0.7);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .blurred-text:active {
            filter: blur(0);
        }
        
        /* === MEDIA QUERIES === */
        @media (max-width: 480px) {
            #typing-text {
                font-size: 1.5em;
            }
            
            .simple-message-box {
                max-height: 180px;
                height: 180px;
                padding: 20px 15px;
            }
            
            .cake {
                width: 150px;
                height: 75px;
            }
            
            .cake::before {
                width: 166px;
            }
            
            .memory-gallery {
                grid-template-columns: repeat(2, 1fr);
                max-width: 320px;
            }
            
            #gift-button,
            #memories-button,
            #show-memories-button {
                font-size: 1.1em;
                padding: 14px 25px;
            }
            
            #submit-wish {
                padding: 14px 20px;
                font-size: 1em;
            }
        }
        
        @media (max-width: 360px) {
            .memory-gallery {
                grid-template-columns: 1fr;
                max-width: 280px;
            }
            
            .voice-player {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .voice-progress {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- START SCREEN -->
    <div id="start-overlay">
        <div>üéÄ For the One Who Matters most ‚ú®</div>
        <div style="font-size: 1.2em; margin-top: 20px;">Ek tap karo Prasanshaüéê‚ú®</div>
    </div>
    
    <!-- FIXED HEADER -->
    <div id="happy-birthday-text">
        <div id="typing-text"></div>
    </div>
    
    <!-- MAIN CONTENT -->
    <div class="center-vertically">
        <div class="content-wrapper">
            <button id="gift-button">Open Your Birthday Gift üéÅ</button>
            <div class="cake-container" id="cake-container">
                <div class="candle"><div class="flame"></div></div>
                <div class="cake"></div>
            </div>
            <button id="memories-button">If You Ever Want To üíå</button>
            
            <!-- SIMPLE MESSAGE BOX (White box with text) -->
            <div class="simple-message-box" id="simple-message-box" style="display: none;">
                <!-- Text will be inserted here by JavaScript -->
            </div>
            
            <button id="show-memories-button">Pieces of You.... üå∏</button>
            <div class="memory-gallery" id="memory-gallery"></div>
            
            <!-- VOICE MESSAGES SECTION -->
            <div id="voice-messages-container">
                <div class="voice-messages-title">Voice Messages üé§</div>
                <div id="voice-messages-list">
                    <!-- Voice messages will be added here by JavaScript -->
                </div>
            </div>
            
            <!-- WISH SECTION (For sending messages to Telegram) -->
            <div id="wish-container">
                <textarea id="wish-text" placeholder="Type your wish/message here... ‚ú®"></textarea>
                <button id="submit-wish">Send Wish to Universe</button>
                <p id="wish-message"></p>
            </div>
        </div>
    </div>
    
    <!-- WELCOME MESSAGES -->
    <div class="welcome-message" id="welcome-1">Hi Cutiepie</div>
    <div class="welcome-message" id="welcome-2">Gulumulu</div>
    <div class="welcome-message" id="welcome-3">Cupcake</div>
    <div class="welcome-message" id="welcome-4">Dumpling</div>
    <div class="welcome-message" id="welcome-5">I know it's unexpected</div>
    
    <!-- LIGHTBOX -->
    <div id="lightbox-modal">
        <button id="lightbox-close">‚úñ</button>
        <button id="lightbox-prev">‚óÄ</button>
        <div class="lightbox-media-container">
            <img id="lightbox-media" src="" alt="">
        </div>
        <div class="lightbox-caption" id="lightbox-caption"></div>
        <button id="lightbox-next">‚ñ∂</button>
    </div>
    
    <div id="final-message-1" class="final-message-container">
    <button id="close-final-1" class="close-btn">‚úñ</button>
    <div class="message-box">
        <div class="message-content">
            <div class="message-title">Jahan bhi life tumhe le jaye...</div>
            <div class="message-body">Kitni bhi dooriyan aaye, time beet jaye...</div>
            <div class="message-highlight">Tum mere liye hamesha woh 18 March 2024 , 8:22 pm wala Prasansha bane rahogeüíü</div>
            <div class="message-body" style="font-style: italic; margin-top: 20px;">- foreverrr...</div>
        </div>
    </div>
</div>

<div id="final-message-2" class="final-message-container">
    <button id="close-final-2" class="close-btn">‚úñ</button>
    <div class="message-box">
        <div class="message-content">
            <div class="message-title">Mujhe pata hai hamare beech dooriyan thi, alag duniya thi...</div>
            <div class="message-body">...aur pichle 649 din se main ek sawal pakda hua tha<br>Kya ho sakta tha hamara?<br><br>Par ab samajh gaya hoon. Mere ehsaas mere apne safar the. Ab 'kyun' matter nahi karta.</div>
            <div class="message-highlight">Tumhari har khushi ki dua hai. Tumhe bhi aapni life jeene ka pura haq hey.</div>
        </div>
    </div>
</div>

<div id="final-message-3" class="final-message-container">
    <button id="close-final-3" class="close-btn">‚úñ</button>
    <div class="message-box">
        <div class="message-content">
            <div class="message-title"> Kuch aur kehni thi tumhe</div>
            <div class="message-body">
                <span class="blurred-text">
                    Un yaadon ke liye shukriya jo kabhi meri zindagi ka hissa thi.  
                    Woh baatein, woh hasi, woh tum jo us waqt thi.  

                    <br><br>
                    Tumhe leke maine jo sapne dekhi thi, aaj unko bhi jaane de rahahu.
                    Sayad maine sandar sakal ke race pe haar geya tumhara samne.
                    Dua karta hu tumhara life pe eisa koi aaye jo tumhara kheyal rakhega. 
                    Hamesha, mere se bhi kahi huna behetar..
                    Lekin mere liye tum hamesha perfect hi thi jo maine kabhi tumjhe samjha nehi paya. 
                </span>
            </div>
        </div>
    </div>
</div>

<div id="final-message-4" class="final-message-container">
    <button id="close-final-4" class="close-btn">‚úñ</button>
    <div class="message-box">
        <div class="message-content">
            <div class="message-title">‚ù§Ô∏è</div>
            <div class="message-body">Haar raat ko goodnight, subha good morning keh pana mere life ka sabse accha part tha... <br>Par woh chapter ab khatam ho gaya.</div>
            <div class="message-highlight">Hamesha khayal rakhna aapna Prasansha. Khush rahna. ‚ú®<br>Tum kabhi moti nehi thi mere aakhon mey. Tum thi mere jinda rehne ka ek light jo aab off hogeya ‚ú®</div>
        </div>
    </div>
</div>

<div id="final-message-5" class="final-message-container">
    <button id="close-final-5" class="close-btn">‚úñ</button>
    <div class="message-box">
        <div class="message-content">
            <div class="message-title"></div>
            <div class="message-body">
                <div class="message-highlight">Ek late si Merry Christmas üéÑ‚ú®<br>Aur Happy New Year üéâ</div>
                <div class="message-body" style="margin-top: 25px;">
                    Mujhe hamesha darr tha ki koi bhi message disturbance hoga,<br>
                    ek aisi awaaz jo tumhare purane past se aa rahi ho jise tum bhool chuki ho.<br><br>
                    Isliye yeh message tumhari zindagi mein wapas aane ke liye nahi,<br>
                    balki hamesha keliye yahan se jaane ke liye hai.<br>
                    Yeh website, yeh logs, mera ek-tarfa pyaar‚Äîmain kitaab band kar raha hoon.<br><br>
                    Itne sab ke baad, ek aakhri baar: "Happy Birthday Madam jiii.....".
                </div>
            </div>
        </div>
    </div>
</div>

<div id="final-message-6" class="final-message-container">
    <button id="close-final-6" class="close-btn">‚úñ</button>
    <div class="message-box">
        <div class="message-content" style="background-color: #000; color: #fff; padding: 20px; border-radius: 15px;">
            <div class="message-title" style="color: #fff;">Tumhara birthday hai, isliye</div>
            <div class="message-body" style="font-size: 1.2em; margin: 30px 0; line-height: 1.6;">
                Tumhe jaane dena aur tumhe waisi zindagi jeene dena jaisi tum jeena chahti ho<br>
                Yeh sabse bada gift hai jo main tumhe de sakta hoon.
            </div>
            <div class="message-highlight" style="font-size: 1.4em; color: #ff6b8b; border-color: #ff6b8b; padding: 15px; border: 2px solid #ff6b8b; border-radius: 10px; margin: 20px 0;">
                Mahi aab is zindagi mein tumhe kabhi disturb nahi karega.<br>
                Aazad raho. Khush raho. Mujhe itna bhool jaao jeyse tum acche se jii sako aur mey tumhe itna yaad rkahunga jisse mai jii saku.
            </div>
            <div class="message-body" style="margin-top: 40px; font-style: italic; opacity: 0.8; font-size: 0.9em;">
                Yeh site, aur yeh pyaar, ab mai bohot tierd ho chuke hoon.<br>
                Kabhi akela feel ho to yaad kar lena ki eisa koi bhi tha jo tumhe aapna pura life se chata tha sirf jo uske haat me nehi tha uskeliye kho diya.<br>
                Good byeee Prasansha... Tumhara haan jiii bohot miss karunga üôÇ
            </div>
        </div>
    </div>
</div>
    <!-- BLACK SCREEN -->
    <div class="black-screen" id="black-screen"></div>
    
    <!-- Audio -->
    <audio id="bg-music" loop>
    <source src="https://dl.dropboxusercontent.com/scl/fi/zualk8fuf5x4rjf2ehj12/Tu_Jaane_Na_Lyrical_-_Ajab_Prem_Ki_Ghazab_Kahani_Atif_Aslam_Ranbir_Kapoor_Katrina_Kaif_Pritam_256KBPS.webm?rlkey=ekswmld5wb9mv6usng7mbgfpq&dl=1" type="audio/webm">
</audio>

    <script>
        // === STATE ===
        let currentIndex = 0;
        let started = false;
        let currentLightboxIndex = 0;
        let isVideoPlaying = false;
        let bgMusicPaused = false;
        let currentlyPlayingAudio = null;
        let wishCount = 3; // Allow 3 wishes
        
        // === ELEMENTS ===
        const startOverlay = document.getElementById('start-overlay');
        const giftButton = document.getElementById('gift-button');
        const cakeContainer = document.getElementById('cake-container');
        const flame = document.querySelector('.flame');
        const memoriesButton = document.getElementById('memories-button');
        const simpleMessageBox = document.getElementById('simple-message-box');
        const showMemoriesButton = document.getElementById('show-memories-button');
        const memoryGallery = document.getElementById('memory-gallery');
        const voiceMessagesContainer = document.getElementById('voice-messages-container');
        const voiceMessagesList = document.getElementById('voice-messages-list');
        const wishContainer = document.getElementById('wish-container');
        const wishText = document.getElementById('wish-text');
        const submitWish = document.getElementById('submit-wish');
        const wishMessage = document.getElementById('wish-message');
        const happyBirthdayText = document.getElementById('happy-birthday-text');
        const typingText = document.getElementById('typing-text');
        const bgMusic = document.getElementById('bg-music');
        const blackScreen = document.getElementById('black-screen');
        
        // Lightbox elements
        const lightboxModal = document.getElementById('lightbox-modal');
        const lightboxMedia = document.getElementById('lightbox-media');
        const lightboxCaption = document.getElementById('lightbox-caption');
        const lightboxClose = document.getElementById('lightbox-close');
        const lightboxNext = document.getElementById('lightbox-next');
        const lightboxPrev = document.getElementById('lightbox-prev');
        
        // Welcome messages
        const welcomeMessages = [
            document.getElementById('welcome-1'),
            document.getElementById('welcome-2'),
            document.getElementById('welcome-3'),
            document.getElementById('welcome-4'),
            document.getElementById('welcome-5')
        ];
        
        // Final messages
     // Final messages
const finalMessages = [
    document.getElementById('final-message-1'),
    document.getElementById('final-message-2'),
    document.getElementById('final-message-3'),
    document.getElementById('final-message-4'),
    document.getElementById('final-message-5'),
    document.getElementById('final-message-6')  // Added this
];

const closeButtons = [
    document.getElementById('close-final-1'),
    document.getElementById('close-final-2'),
    document.getElementById('close-final-3'),
    document.getElementById('close-final-4'),
    document.getElementById('close-final-5'),
    document.getElementById('close-final-6')  // Added this
];
        
        // === VOICE MESSAGES DATA ===
        const voiceMessages = [
            {
                url: 'https://dl.dropboxusercontent.com/scl/fi/nje42x62vs4rtwghssq63/Itna-chata-marungi-kiss.mp3?rlkey=e8khfrgei0sbekhft1udcvr4v&st=xqp5l1y9&dl=1&raw=1',
                placeholder: "Itna chata marungi‚Ä¶ aur woh kiss‚Äîmaine sach mein dil se chaha tha."
            },
            {
                url: 'https://dl.dropboxusercontent.com/scl/fi/z4moqjghnkuj683oyeotu/ghatiya-lag-rahahey-hoga-fir-bhi-aapko-bhej-diya.mp3?rlkey=ih9c1a9v1jzbcav2e49n6kqdv&st=fflln4cr&dl=1&raw=1',
                placeholder: "Tumhe baat karna nehi aata?? Tumhara purana msg dekhke aabhi bhi khus rehta hu mai. Aur tumhara voice ghatiya nehi tha, wo to koi jannat ka sound jeysa lagta tha mujhe."
            },
            {
                url: 'https://dl.dropboxusercontent.com/scl/fi/qyt9nm5me6xmvu292li2q/english-sunke-fiuse.mp3?rlkey=8tym6r9p0g4yfyo8uqxrwj4rn&st=3z53byjz&dl=1&raw=1',
                placeholder: "Tumhari English sayad perfect nehi hai, par mere dil ke liye tum, tumhara wo non perfect word hi perfect tha"
            },
            {
                url: 'https://dl.dropboxusercontent.com/scl/fi/6c9giv94f2izxq9ctuon4/Awaz-hamesha-bura-hota-hy-lekin-hasna-maat.mp3?rlkey=29wjhreazob18pn75t12whhtv&st=c114yolu&dl=1&raw=1',
                placeholder: "Log kehte hain ek hi cheez baar-baar sunne se boring ho jaati hai. Main do saal se har raat wahi awaaz sunta hoon. Mujhe to kabhi boring nahi lagta. Kuch awaazein sirf sunne ke liye nahi hoti‚Äîwoh saath reh jaati hain"
            }
        ];
        
        // === MEMORIES DATA ===
        const memories = [
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/jwr4vspirerbzz4dc74da/IMG-20250718-WA0060.jpg?rlkey=ji352spt12i6momseziz49080&st=zfss0noo&dl=1&raw=1' },
            { type: 'video', url: 'https://dl.dropboxusercontent.com/scl/fi/05l3vcsvgebwen673ra27/VID-20250718-WA0018.mp4?rlkey=lkeuttwo68l2p7c48u8a72ykh&st=pu4hrzpa&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/603qdagaor5u3ek10tjs6/IMG-20250718-WA0061.jpg?rlkey=8ugmvmekjk2pwacynhwrw9lb9&st=87z4hskz&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/lngj4243ahoqeg750c46o/IMG-20250718-WA0059.jpg?rlkey=2h4e4nzzx57rivf42mo5ae44m&st=0mzb1ckf&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/uiot74i488yuhwaq2p0jl/IMG-20250718-WA0058.jpg?rlkey=hj8rhkpxt7slzsy56i6b3r8no&st=fjetct7a&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/li3fvkj4z9ksea6w8ed8j/IMG-20250718-WA0057.jpg?rlkey=8s7z3eol4e3azvva48anjeybo&st=ybojoaie&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/l8ypf8o3c02evlmk5p68u/IMG_20251101_235252_485.jpg?rlkey=xokyjg9396vral1r9wn26emq5&st=hjl3n27s&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/0j8dopua4x3qudgmb24d0/IMG_20251101_235246_563.jpg?rlkey=8c97s098e1gwyshwtld3am3nz&st=zrpvxok1&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/uou6riqsfjpn6cgpaivd6/IMG_20251101_235243_458.jpg?rlkey=kp8e1sdvyjgvphv51pe6u06ga&st=h41ybcmv&dl=1&raw=1' },
            { type: 'image', url: 'https://dl.dropboxusercontent.com/scl/fi/3hqion58o3t5s0q3e3y6b/IMG_20251101_235239_710.jpg?rlkey=eqspt6rb8hycotf7ilipg4ejc&st=ugeltzsp&dl=1&raw=1' },
            { type: 'video', url: 'https://dl.dropboxusercontent.com/scl/fi/ehuy2s44g1ftv4a89ng1h/video_251231_195220.mp4?rlkey=lw03racky734kobk02eugtquy&st=l8vu9kxz&dl=1&raw=1' }
        ];

        const memoryCaptions = [
            "That look‚Ä¶ I could get lost in it forever üåπ",
            "Jab tum lip-sync karti ho, har ek lafz tumhari smile se aur bhi magical lagta hai‚Ä¶ üéµüíñ",
            "That face, that smile‚Ä¶ Har photo mein tumhari khubsurti aur pyar mujhe mehsoos hota hai, jaise duniya ki har khoobsurti tumhare andar hi base ho ‚ù§Ô∏èüå∏",
            "Bas yahi soch sakta hoon‚Ä¶ tum har tareeke se gorgeous ho ‚ù§Ô∏èüêæ",
            "Red hair, twinkling smile‚Ä¶ tumhari khubsurti aisi hai ki main shayad kabhi kisi aur mein nahi dekh paunga üéê",
            "Woh khula aasman aur tum‚Ä¶ jaise duniya ke saare stars bas tumhari hi taraf dekh rahe ho ‚ú®üíñ.",
            "Kaash tumhara cheeks pe kiss kar pata. Kitna llucky wo banda hoga jiska luck pe tum likhi ho üíì",
            "Bas tumhari aankhon mein kho jaane ka mann karta hai‚Ä¶ jaise duniya thodi si silent ho jaaye aur sirf tum aur ye pal rahe ‚ú®üñ§",
            "Har photo mein tumhari ek alag charm hai‚Ä¶ jaise tum khud ek little universe ho üå∏üåü",
            "Perfection exists, aur main use hi dekh raha hoon üåü",
            "Tumhari har ek movement, har ek expression... sab kuch itna beautiful hai ki main bus dekhkar reh jaata hoon üíï"
        ];
        
        // === START EXPERIENCE ===
        startOverlay.addEventListener('click', startExperience);
        
        function startExperience() {
            if (started) return;
            started = true;
            
            // Fade out start overlay
            startOverlay.style.opacity = '0';
            startOverlay.style.transition = 'opacity 0.6s ease';
            setTimeout(() => {
                startOverlay.style.display = 'none';
            }, 600);
            
            // Start background music
            bgMusic.volume = 0.3;
            bgMusic.play().catch(e => {
                console.log('Audio autoplay blocked - user interaction needed');
            });
            
            // Show welcome sequence
            showWelcomeSequence();
        }
        
        function showWelcomeSequence() {
            welcomeMessages.forEach((msg, index) => {
                setTimeout(() => {
                    msg.style.opacity = '1';
                    msg.style.transition = 'opacity 0.5s ease';
                    
                    setTimeout(() => {
                        msg.style.opacity = '0';
                        
                        if (index === welcomeMessages.length - 1) {
                            setTimeout(() => {
                                giftButton.classList.add('show');
                            }, 500);
                        }
                    }, 1000);
                }, index * 1500);
            });
        }
        
        // === GIFT BUTTON ===
        giftButton.addEventListener('click', function() {
            this.style.display = 'none';
            cakeContainer.style.display = 'block';
            createBalloons(6);
        });
        
       // === SCREEN CLICK TO LIGHT CANDLE ===
document.addEventListener('click', function(event) {
    // Only trigger if candle is not already burning AND cake is visible
    if (!flame.classList.contains('burning') && cakeContainer.style.display === 'block') {
        // Don't trigger if clicking on gift button (to avoid double trigger)
        if (event.target !== giftButton && !giftButton.contains(event.target)) {
            flame.classList.add('burning');
            
            setTimeout(() => {
                showBirthdayText();
            }, 600);
        }
    }
});
        
        function showBirthdayText() {
            happyBirthdayText.style.display = 'block';
            const text = "Happy Birthday Prasansha! ‚ú®";
            let i = 0;
            
            function type() {
                if (i < text.length) {
                    typingText.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, 80);
                } else {
                    setTimeout(() => {
                        memoriesButton.style.display = 'block';
                    }, 500);
                }
            }
            type();
        }
        
        // === MEMORIES BUTTON (If You Ever Want To) ===
        memoriesButton.addEventListener('click', function() {
            this.style.display = 'none';
            simpleMessageBox.style.display = 'block';
            
            const message = `Happy Birthday Prasansha! üéâüíñ

Aaj ka din sirf tumhara hai.
Ye saal tumhare liye naye sapne, pyaar aur khushiyan laaye.
Har pal tumhare liye khaas ho, aur tum hamesha itni hi roshni aur sundarta lekar jeeti raho.

Tumhari muskaan duniya mein sabse alag hai, aur tumhari khushi sabse important.
Main sirf door se dekh sakta hoon, par phir bhi ye chahta hoon ki tumhara har pal khaas ho, jaise tum sach mein anmol ho.

Apne din ka poora maza lo, Prasansha,
Kyuki tum har pal, har nazar mein, beintehaa khaas ho. ‚ú®üéÇüéÅ`;
            
            // Type the message in the simple box
            typeSimpleMessage(message, () => {
                setTimeout(() => {
                    showMemoriesButton.style.display = 'block';
                }, 300);
            });
        });
        
        function typeSimpleMessage(text, callback) {
            let i = 0;
            simpleMessageBox.textContent = '';
            
            function type() {
                if (i < text.length) {
                    simpleMessageBox.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, 30);
                } else if (callback) {
                    setTimeout(callback, 500);
                }
            }
            type();
        }
        
        // === SHOW MEMORIES BUTTON (Pieces of You) ===
        showMemoriesButton.addEventListener('click', function() {
            this.style.display = 'none';
            simpleMessageBox.style.display = 'block';
            
            const memoryText = "Maine ye Little universes ab tak sambhal ke rakhi hain. Ye tumhara ek hissa hain jo main bhool nahi sakta. Tumhari muskurahat, tumhari aankhein, tum...Inhe dekhkar lagta hai jaise tum yahin ho. Mere saath mere paas üå∏";
            
            typeSimpleMessage(memoryText, () => {
                memoryGallery.style.display = 'grid';
                loadMemories();
            });
        });
        
        // === LOAD MEMORIES ===
        function loadMemories() {
            memories.forEach((mem, index) => {
                const item = document.createElement('div');
                item.className = 'memory-item';
                
                if (mem.type === 'image') {
                    const img = document.createElement('img');
                    img.src = mem.url;
                    img.loading = 'lazy';
                    img.alt = `Memory ${index + 1}`;
                    item.appendChild(img);
                } else {
                    const video = document.createElement('video');
                    video.src = mem.url;
                    video.muted = true;
                    video.loop = true;
                    video.autoplay = true;
                    video.playsInline = true;
                    item.appendChild(video);
                }
                
                item.addEventListener('click', () => openLightbox(index));
                memoryGallery.appendChild(item);
            });
            
            setTimeout(() => {
                voiceMessagesContainer.style.display = 'block';
                loadVoiceMessages();
            }, 800);
        }
        
        // === LOAD VOICE MESSAGES ===
        function loadVoiceMessages() {
            voiceMessagesList.innerHTML = '';
            
            let loadedAudioCount = 0;
            
            voiceMessages.forEach((voice, index) => {
                const voiceItem = document.createElement('div');
                voiceItem.className = 'voice-message-item';
                voiceItem.dataset.index = index;
                
                const audio = new Audio();
                audio.src = voice.url;
                audio.preload = 'metadata';
                
                const voiceItemHTML = `
                    <div class="voice-player">
                        <button class="voice-play-btn" data-index="${index}">‚ñ∂</button>
                        <div class="voice-progress">
                            <div class="voice-progress-bar" style="width: 0%"></div>
                        </div>
                        <div class="voice-time">0:00</div>
                    </div>
                    <textarea class="voice-caption-input" placeholder="${voice.placeholder}" rows="3"></textarea>
                `;
                
                voiceItem.innerHTML = voiceItemHTML;
                voiceMessagesList.appendChild(voiceItem);
                
                // Setup audio player
                const playBtn = voiceItem.querySelector('.voice-play-btn');
                const progressBar = voiceItem.querySelector('.voice-progress-bar');
                const timeDisplay = voiceItem.querySelector('.voice-time');
                
                audio.addEventListener('loadedmetadata', () => {
                    timeDisplay.textContent = formatTime(0) + ' / ' + formatTime(audio.duration);
                    
                    loadedAudioCount++;
                    if (loadedAudioCount === voiceMessages.length) {
                        setTimeout(() => {
                            wishContainer.style.display = 'block';
                            updateWishButton();
                        }, 300);
                    }
                });
                
                audio.addEventListener('timeupdate', () => {
                    if (audio.duration) {
                        const progress = (audio.currentTime / audio.duration) * 100;
                        progressBar.style.width = `${progress}%`;
                        timeDisplay.textContent = formatTime(audio.currentTime) + ' / ' + formatTime(audio.duration);
                    }
                });
                
                audio.addEventListener('ended', () => {
                    playBtn.classList.remove('playing');
                    playBtn.textContent = '‚ñ∂';
                    progressBar.style.width = '0%';
                    timeDisplay.textContent = '0:00 / ' + formatTime(audio.duration);
                    
                    if (bgMusicPaused && !isVideoPlaying) {
                        setTimeout(() => {
                            bgMusic.play().catch(e => console.log('Could not resume music'));
                            bgMusicPaused = false;
                        }, 300);
                    }
                });
                
                audio.addEventListener('pause', () => {
                    playBtn.classList.remove('playing');
                    playBtn.textContent = '‚ñ∂';
                });
                
                playBtn.addEventListener('click', () => {
                    if (currentlyPlayingAudio && currentlyPlayingAudio !== audio) {
                        currentlyPlayingAudio.pause();
                        currentlyPlayingAudio.currentTime = 0;
                        const previousBtn = document.querySelector('.voice-play-btn.playing');
                        if (previousBtn) {
                            previousBtn.classList.remove('playing');
                            previousBtn.textContent = '‚ñ∂';
                        }
                    }
                    
                    if (audio.paused) {
                        if (!bgMusic.paused) {
                            bgMusic.pause();
                            bgMusicPaused = true;
                        }
                        
                        audio.play();
                        playBtn.classList.add('playing');
                        playBtn.textContent = '‚è∏';
                        currentlyPlayingAudio = audio;
                    } else {
                        audio.pause();
                        playBtn.classList.remove('playing');
                        playBtn.textContent = '‚ñ∂';
                        
                        if (bgMusicPaused && !isVideoPlaying) {
                            bgMusic.play().catch(e => console.log('Could not resume music'));
                            bgMusicPaused = false;
                        }
                    }
                });
                
                // Update caption when user types
                const captionInput = voiceItem.querySelector('.voice-caption-input');
                captionInput.addEventListener('input', () => {
                    console.log(`Caption for voice ${index}:`, captionInput.value);
                });
            });
            
            // Safety timeout in case audio loading fails
            setTimeout(() => {
                if (!wishContainer.style.display || wishContainer.style.display === 'none') {
                    wishContainer.style.display = 'block';
                    updateWishButton();
                }
            }, 4000);
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        // === WISH SECTION - TELEGRAM FUNCTIONALITY ===
        function updateWishButton() {
            submitWish.textContent = `Send Wish to Universe (${wishCount} left)`;
            submitWish.disabled = wishCount <= 0;
        }
        
        // Enter key support for wish
        wishText.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey && wishCount > 0) {
                e.preventDefault();
                sendWishToTelegram();
            }
        });
        
        submitWish.addEventListener('click', sendWishToTelegram);
        
        function sendWishToTelegram() {
            const wish = wishText.value.trim();
            if (!wish || wishCount <= 0) return;
            
            submitWish.textContent = 'Sending...';
            submitWish.disabled = true;
            
            // Your Telegram bot details
            const botToken = '8233623504:AAHOce1na68q9d8IZNnA8WE_Ca_eL19CTSs';
            const chatId = '6643918586'; // Your Telegram chat ID
            const telegramMessage = `üéÇ New Birthday Wish from Prasansha:\n\n"${wish}"`;
            
            fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ chat_id: chatId, text: telegramMessage })
            })
            .then(response => response.json())
            .then(data => {
                wishCount--;
                wishMessage.textContent = `‚úÖ Wish sent successfully! ${wishCount} wish${wishCount !== 1 ? 'es' : ''} left.`;
                wishMessage.style.display = 'block';
                wishText.value = '';
                
                updateWishButton();
                
                if (wishCount <= 0) {
                    wishText.disabled = true;
                    wishText.placeholder = "All wishes sent! Thank you! ‚ú®";
                    
                    setTimeout(() => {
                        document.querySelector('.content-wrapper').style.opacity = '0';
                        setTimeout(() => {
                            showFinalMessage(0);
                        }, 1000);
                    }, 2000);
                }
                
                // Celebration effects
                createConfetti();
                createHeartPulse();
            })
            .catch(error => {
                wishMessage.textContent = '‚ö†Ô∏è Failed to send. Please try again.';
                wishMessage.style.display = 'block';
                console.error('Telegram error:', error);
            })
            .finally(() => {
                submitWish.disabled = false;
                updateWishButton();
                
                setTimeout(() => {
                    wishMessage.style.display = 'none';
                }, 3000);
            });
        }
        
        // === FINAL MESSAGES FLOW ===
        function showFinalMessage(index) {
            if (index >= finalMessages.length) {
                return;
            }
            
            finalMessages[index].style.display = 'flex';
            setTimeout(() => {
                const messageBox = finalMessages[index].querySelector('.message-box');
                if (messageBox) messageBox.classList.add('show');
            }, 100);
        }
        
        // === FUNCTION TO SHOW BLACK SCREEN (WITH AUDIO CONTINUING) ===
        function showBlackScreen() {
            // KEEP background music playing - DON'T pause it
            // Only pause voice messages if playing
            if (currentlyPlayingAudio && !currentlyPlayingAudio.paused) {
                currentlyPlayingAudio.pause();
                const playingBtn = document.querySelector('.voice-play-btn.playing');
                if (playingBtn) {
                    playingBtn.classList.remove('playing');
                    playingBtn.textContent = '‚ñ∂';
                }
            }
            
            // Pause any video
            const videos = document.querySelectorAll('video');
            videos.forEach(video => {
                if (!video.paused) video.pause();
            });
            
            // Fade out all content except the black screen
            const allElements = document.querySelectorAll('body > *:not(.black-screen)');
            allElements.forEach(el => {
                if (el.style.display !== 'none') {
                    el.style.opacity = '0';
                    el.style.transition = 'opacity 1s ease';
                }
            });
            
            // Show black screen after a delay
            setTimeout(() => {
                blackScreen.style.display = 'block';
                setTimeout(() => {
                    blackScreen.style.transition = 'opacity 2s ease';
                    blackScreen.style.opacity = '1';
                    
                    // Ensure background music continues to play
                    if (bgMusic.paused) {
                        bgMusic.play().catch(e => console.log('Could not resume music'));
                    }
                }, 100);
            }, 1000);
        }
        
        closeButtons.forEach((btn, index) => {
            btn.addEventListener('click', () => {
                const messageBox = finalMessages[index].querySelector('.message-box');
                if (messageBox) messageBox.classList.remove('show');
                
                setTimeout(() => {
                    finalMessages[index].style.display = 'none';
                    
                    // Check if this is the last message
                   // Check if this is the last message
if (index === finalMessages.length - 1) {
    // Show black screen after last message
    showBlackScreen();
} else {
    showFinalMessage(index + 1);
}
                }, 500);
            });
        });
        
        // Blurred text interaction
        document.querySelectorAll('.blurred-text').forEach(text => {
            text.addEventListener('click', function() {
                this.style.filter = 'blur(0)';
            });
            
            text.addEventListener('touchstart', function() {
                this.style.filter = 'blur(0)';
            });
        });
        
        // === LIGHTBOX ===
        function openLightbox(index) {
            currentLightboxIndex = index;
            showLightboxMedia(index);
            lightboxModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        function showLightboxMedia(index) {
            const mem = memories[index];
            const container = document.querySelector('.lightbox-media-container');
            container.innerHTML = '';
            lightboxCaption.textContent = '';
            
            let media;
            if (mem.type === 'image') {
                media = document.createElement('img');
                media.src = mem.url;
                media.id = 'lightbox-media';
            } else {
                media = document.createElement('video');
                media.src = mem.url;
                media.controls = true;
                media.id = 'lightbox-media';
                media.autoplay = false;
                
                media.addEventListener('play', function() {
                    isVideoPlaying = true;
                    if (!bgMusic.paused) {
                        bgMusic.pause();
                        bgMusicPaused = true;
                    }
                    
                    if (currentlyPlayingAudio) {
                        currentlyPlayingAudio.pause();
                        const playingBtn = document.querySelector('.voice-play-btn.playing');
                        if (playingBtn) {
                            playingBtn.classList.remove('playing');
                            playingBtn.textContent = '‚ñ∂';
                        }
                    }
                });
                
                media.addEventListener('pause', function() {
                    isVideoPlaying = false;
                    if (bgMusicPaused && !lightboxModal.contains(document.activeElement)) {
                        bgMusic.play().catch(e => console.log('Could not resume music'));
                        bgMusicPaused = false;
                    }
                });
                
                media.addEventListener('ended', function() {
                    isVideoPlaying = false;
                    if (bgMusicPaused) {
                        bgMusic.play().catch(e => console.log('Could not resume music'));
                        bgMusicPaused = false;
                    }
                });
            }
            
            media.style.maxWidth = '100%';
            media.style.maxHeight = '60vh';
            container.appendChild(media);
            
            if (memoryCaptions[index]) {
                lightboxCaption.textContent = memoryCaptions[index];
            }
        }
        
        function nextMedia() {
            currentLightboxIndex = (currentLightboxIndex + 1) % memories.length;
            
            const currentMedia = document.querySelector('#lightbox-media');
            if (currentMedia && currentMedia.tagName === 'VIDEO' && !currentMedia.paused) {
                currentMedia.pause();
                isVideoPlaying = false;
                if (bgMusicPaused) {
                    bgMusic.play().catch(e => console.log('Could not resume music'));
                    bgMusicPaused = false;
                }
            }
            
            showLightboxMedia(currentLightboxIndex);
        }

        function prevMedia() {
            currentLightboxIndex = (currentLightboxIndex - 1 + memories.length) % memories.length;
            
            const currentMedia = document.querySelector('#lightbox-media');
            if (currentMedia && currentMedia.tagName === 'VIDEO' && !currentMedia.paused) {
                currentMedia.pause();
                isVideoPlaying = false;
                if (bgMusicPaused) {
                    bgMusic.play().catch(e => console.log('Could not resume music'));
                    bgMusicPaused = false;
                }
            }
            
            showLightboxMedia(currentLightboxIndex);
        }
        
        function closeLightbox() {
            const currentMedia = document.querySelector('#lightbox-media');
            if (currentMedia && currentMedia.tagName === 'VIDEO' && !currentMedia.paused) {
                currentMedia.pause();
                isVideoPlaying = false;
            }
            
            if (bgMusicPaused) {
                bgMusic.play().catch(e => console.log('Could not resume music'));
                bgMusicPaused = false;
            }
            
            lightboxModal.style.display = 'none';
            document.body.style.overflow = '';
        }

        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                if (isVideoPlaying) {
                    const video = document.querySelector('#lightbox-media');
                    if (video && video.tagName === 'VIDEO') {
                        video.pause();
                    }
                }
                
                if (currentlyPlayingAudio && !currentlyPlayingAudio.paused) {
                    currentlyPlayingAudio.pause();
                    const playingBtn = document.querySelector('.voice-play-btn.playing');
                    if (playingBtn) {
                        playingBtn.classList.remove('playing');
                        playingBtn.textContent = '‚ñ∂';
                    }
                }
            }
        });
        
        lightboxClose.addEventListener('click', closeLightbox);
        lightboxNext.addEventListener('click', nextMedia);
        lightboxPrev.addEventListener('click', prevMedia);
        
        // Swipe support for mobile
        let touchStartX = 0;
        let touchEndX = 0;
        
        lightboxModal.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        lightboxModal.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    nextMedia();
                } else {
                    prevMedia();
                }
            }
        }
        
        // === PARTICLE EFFECTS ===
        function createBalloons(count) {
            const colors = ['#ff85a2', '#e84393', '#dda0dd', '#ffb6c1'];
            
            for (let i = 0; i < count; i++) {
                const balloon = document.createElement('div');
                balloon.style.cssText = `
                    position: fixed;
                    width: 40px;
                    height: 50px;
                    background: ${colors[i % colors.length]};
                    border-radius: 50%;
                    bottom: -50px;
                    left: ${Math.random() * 100}%;
                    animation: floatUp 8s ease-in forwards;
                    z-index: 1;
                    pointer-events: none;
                `;
                document.body.appendChild(balloon);
                
                setTimeout(() => balloon.remove(), 8000);
            }
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes floatUp {
                    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
                    100% { transform: translateY(-100vh) rotate(20deg); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
        
        function createConfetti() {
            for (let i = 0; i < 15; i++) {
                const confetti = document.createElement('div');
                confetti.style.cssText = `
                    position: fixed;
                    width: 6px;
                    height: 6px;
                    background: hsl(${Math.random() * 360}, 70%, 60%);
                    top: 20%;
                    left: ${Math.random() * 100}%;
                    animation: confettiFall 1.5s ease-out forwards;
                    z-index: 2;
                    pointer-events: none;
                    border-radius: 2px;
                `;
                document.body.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 1500);
            }
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes confettiFall {
                    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
                    100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
        
        function createHeartPulse() {
            const heart = document.createElement('div');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0);
                font-size: 3em;
                z-index: 9999;
                animation: heartPulse 1s ease-out forwards;
                pointer-events: none;
            `;
            document.body.appendChild(heart);
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes heartPulse {
                    0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
                    70% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.7; }
                    100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            setTimeout(() => heart.remove(), 1000);
        }
        
        // === INITIALIZE ===
        updateWishButton();
        
        // Mobile optimizations
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) e.preventDefault();
        }, { passive: false });
        
        let lastTap = 0;
        document.addEventListener('touchend', function(e) {
            const currentTime = new Date().getTime();
            const tapLength = currentTime - lastTap;
            if (tapLength < 300 && tapLength > 0) {
                e.preventDefault();
            }
            lastTap = currentTime;
        });
        
        // Error handling
        window.addEventListener('error', function(e) {
            console.error('Page error:', e.error);
            return true;
        });
    </script>
</body>
</html>
